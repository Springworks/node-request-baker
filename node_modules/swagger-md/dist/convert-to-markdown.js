'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = convertToMarkdown;

var _resolveApiSpec = require('./resolve-api-spec');

var _resolveApiSpec2 = _interopRequireDefault(_resolveApiSpec);

var _introGenerator = require('./generators/intro-generator');

var _introGenerator2 = _interopRequireDefault(_introGenerator);

var _tocGenerator = require('./generators/toc-generator');

var _tocGenerator2 = _interopRequireDefault(_tocGenerator);

var _pathGenerator = require('./generators/path-generator');

var _pathGenerator2 = _interopRequireDefault(_pathGenerator);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const paths_header = 'Endpoints';

function convertPaths(paths, response_example_provider) {
  return [`## ${paths_header}`, Object.keys(paths).map(path_key => {
    return _pathGenerator2.default.generatePath(path_key, paths[path_key], response_example_provider);
  }).join('\n\n')].join('\n\n');
}

function convertToMarkdown(swagger_spec, options) {
  return (0, _resolveApiSpec2.default)(swagger_spec, options).then(spec => {
    const opts = options || {};
    const intro = _introGenerator2.default.generateApiIntro(spec);
    const toc = _tocGenerator2.default.generateTableOfContents(paths_header, spec.paths);
    const paths = convertPaths(spec.paths, opts.response_example_provider);
    return `${intro}\n\n${toc}\n\n${paths}\n`;
  });
}